---
title: "Death Rates of Cancer, Diabetes Mellitus, and Heart Disease in Eurozone"
author: "Clementine Surya"
output: html_document
---

```{r global_options, include=FALSE, cache=FALSE}
knitr::opts_knit$set(root.dir = "/Users/clementine/Desktop/Github/R-Projects/Death Rates of Cancer, Diabetes, Heart Disease in Eurozone")
library(knitr)
opts_chunk$set(echo=TRUE, 
               warning=FALSE, 
               message=FALSE,
               cache = FALSE,
               include = TRUE,
               results = 'show',
               error = TRUE)
```

# Load necessary package
First of all, I load in necessary package.
```{r}
library("tidyverse")
library("dplyr")  
library("tidyr")
library("ggplot2")
library("readxl") #To read xlxs file
library("gridExtra") #To show ggplot side by side
```

# Part 1: Analysis 
The aim for part 1 is to find dataset that contains of mix of categorical and numerical variables. I choose three dataset from Eurostat website which contains the death rates that were caused by Cancer, Diabetes Mellitus, and Heart Disease in Eurozone by Gender for Year 2017, 2018, and 2019.\

The death rate describes mortality in relation to the total population. Expressed in deaths per 100, 000 inhabitants, it is calculated as the number of deaths recorded in the population for a given period divided by population in the same period and then multiplied by 100,000.\

Below are the links to the datasets:\


- Death due to Cancer: https://ec.europa.eu/eurostat/databrowser/view/TPS00116/default/table?lang=en&category=hlth.hlth_cdeath.hlth_cd_gmor 


- Death due to Diabetes Mellitus: https://ec.europa.eu/eurostat/databrowser/view/TPS00137/default/table?lang=en&category=hlth.hlth_cdeath.hlth_cd_gmor


- Death due to heart disease: https://ec.europa.eu/eurostat/databrowser/view/TPS00119/default/table?lang=en&category=hlth.hlth_cdeath.hlth_cd_gmor

In these dataset, the categorical columns are: Country and Year while the numerical columns are: Death Rates of Cancer, Diabetes Mellitus, and Heart Disease (by genders).\

To sum up for the analysis part:\
1. Death Rates that were caused by Cancer, Diabetes Mellitus, and Heart Disease were all higher among male than female.\
2. By comparing death of rate caused by Cancer, Diabetes Mellitus, and Heart Disease, the cause of death by Cancer is the highest, followed by Heart Disease, and the last is Diabetes Mellitus in every year from 2017 to 2019.\
3. The highest death rate caused by Cancer in 2019 for male was in Latvia, while for female was in Hungary.\
4. The highest death rate caused by Diabetes Mellitus in 2019 for both male and female were in Croatia.\
5. The highest death rate caused by Heart Disease in 2019 for both male and female were in Lithuania.\
6. The top four most strongly correlated pairs for the numerical variables are shown below:\

- Heart males death rate and heart females death rate have a strong positive correlation with correlation of 0.98.\
- Diabetes males death rate and diabetes females death rate have a strong positive correlation with correlation of 0.97.\
- Cancer males death rate and heart males death rate have a moderate positive correlation with correlation of 0.66.\
- Cancer males death rate and cancer females death rate have a moderate positive correlation with correlation of 0.64.\


7. When predicting the cancer males death rates, the predictor: cancer females death rate, diabetes males death rate, diabetes females death rate have p-value < 0.05 (using 5% significance level). Thus, these variables are considered as significant predictor. Furthermore, the adjusted  $R^{2}$  in this fitted model which is 0.6963. Thus, 69.63% of the variation in cancer males death ratecan be explained by the fitted model.\


## Load the dataset
In this part, I load all the three dataset and combine them into one.

### Cancer Death Rate Dataset
Load Cancer death rate dataset and tidy this dataset by removing rows that are not being used and removing the missing values.
```{r}
#Load Cancer Death Rate dataset
df_cancer = read_excel("cancer.xlsx", skip = 9)
#Remove 7 rows in the bottom of this dataset
df_cancer = slice(df_cancer, 1:(n() - 7))
```

Here, I count the ":" symbol that needs to be removed
```{r}
#Count ":" symbol in the data that we want to remove
sum(df_cancer == ":")    
```

Replace ":" value with NA and removing the the 24 missing values from this dataset.
```{r}
#Replace ":" symbol with NA value
df_cancer <- replace(df_cancer, df_cancer==":", NA)
#Remove NA value from this dataset
df_cancer <- df_cancer %>% drop_na()
```

```{r}
#Change the death rate from character to numeric value
i <- c(3, 4)
df_cancer[ , i] <- apply(df_cancer[ , i], 2,            
                         function(x) as.numeric(as.character(x)))
#Rename the column names of this dataset
names(df_cancer) <- c('country','year','cancer_males','cancer_females')
#Then, I print the head, structure, and dimension of the cancer death rate dataset 
head(df_cancer)
str(df_cancer)
dim(df_cancer)
```
### Diabetes Death Rate Dataset
Load Diabetes death rate dataset and tidy the data using the same method as above.
```{r}
#Load Diabetes Death Rate dataset
df_diabetes = read_excel("diabetes.xlsx", skip = 9)
#Remove 7 rows in the bottom of this dataset
df_diabetes = slice(df_diabetes, 1:(n() - 7))
```

Here, I count the ":" symbol that needs to be removed
```{r}
#Count ":" symbol in the data that we want to remove
sum(df_diabetes == ":")    
```

Replace ":" value with NA and removing the the 24 missing values from this dataset.
```{r}
#Replace ":" symbol with NA value
df_diabetes <- replace(df_diabetes, df_diabetes==":", NA)
#Remove NA value from this dataset
df_diabetes <- df_diabetes %>% drop_na()
```

```{r}
#Change the death rate from character to numeric value
i <- c(3, 4)
df_diabetes[ , i] <- apply(df_diabetes[ , i], 2,            
                         function(x) as.numeric(as.character(x)))
#Remove NA value from this dataset
df_diabetes <- df_diabetes %>% drop_na()
#Rename the column names of this dataset
names(df_diabetes) <- c('country','year','diabetes_males','diabetes_females')
#Then, I print the head, structure, and dimension of the diabetes death rate dataset 
head(df_diabetes)
str(df_diabetes)
dim(df_diabetes)
```

### Heart Disease Death Rate Dataset
The last dataset is Heart Disease dataset and here I load the data and tidy the data.
```{r}
#Load Heart Disease Death Rate dataset
df_heart = read_excel("heart_disease.xlsx", skip = 9)
#Remove 7 rows in the bottom of this dataset
df_heart = slice(df_heart, 1:(n() - 7))
```

Here, I count the ":" symbol that needs to be removed
```{r}
#Count ":" symbol in the data that we want to remove
sum(df_heart == ":")    
```

Replace ":" value with NA and removing the the 24 missing values from this dataset.
```{r}
#Replace ":" symbol with NA value
df_heart <- replace(df_heart, df_heart==":", NA)
#Remove NA value from this dataset
df_heart <- df_heart %>% drop_na()
```

```{r}
#Change the death rate from character to numeric value
i <- c(3, 4)
df_heart[ , i] <- apply(df_heart[ , i], 2,            
                         function(x) as.numeric(as.character(x)))
#Remove NA value from this dataset
df_heart <- df_heart %>% drop_na()
#Rename the column names of this dataset
names(df_heart) <- c('country','year','heart_males','heart_females')
#Then, I print the head, structure, and dimension of the heart disease death rate dataset
head(df_heart)
str(df_heart)
dim(df_heart)
```
### Combine the dataset
After loading and cleaning all the three datasets, I combine them into one dataset which is called "df_all". This new dataset has 99 rows and 8 columns.
```{r}
#First, I combine Cancer and Diabetes Death Rate datasets together
df_cancer_diabetes =  df_cancer %>% right_join(df_diabetes, by=c("country","year"))
#Then, I combine all the data together into one dataset. This dataset will be used throughout the analysis part below
df_all =  df_cancer_diabetes %>% right_join(df_heart, by=c("country","year"))
#Print the head, structure, and dimension of the combined dataset
head(df_all)
str(df_all)
dim(df_all)
```

## Numerical Summary
I begin the analysis part by showing the numerical summary for each year:
```{r}
by(df_all, df_all$year, summary)
```

First of all, I analyse the death rate that was caused by Cancer per year for both male and female:\
- In 2017, male had death rate caused by cancer with mean 342.0 and median 323.3 (indicating a right skewed distribution) while female had death rate caused by cancer with mean 198.6 and median 201 (indicating a left skewed distribution).\
- In 2018, male had death rate caused by cancer with mean 338.2 and median 320.0  (indicating a right skewed distribution) while female had death rate caused by cancer with mean 196.8 and median 198.2 (indicating a left skewed distribution).\
- In 2019, male had death rate caused by cancer with mean 331.5 and median 321.9  (indicating a right skewed distribution) while female had death rate caused by cancer with mean 192.8 and median 191.6 (indicating a right skewed distribution).\

From above analysis of cancer death rate, we can see in all the years, the cancer date rate was higher among men than women.

Second of all, I analyse the death rate that was caused by Diabetes per year for both male and female:\
- In 2017, male had death rate caused by diabetes with mean 28.54 and median 23.34 (indicating a right skewed distribution) while female had death rate caused by diabetes with mean 22.11 and median 16.29  (indicating a right skewed distribution).\
- In 2018, male had death rate caused by diabetes with mean 29.58 and median 22.76  (indicating a right skewed distribution) while female had death rate caused by diabetes with mean 22.32 and median 16.68 (indicating a right skewed distribution).\
- In 2019, male had death rate caused by diabetes with mean 30.31 and median 24.04  (indicating a right skewed distribution) while female had death rate caused by diabetes with mean 22.81 and median 16.64 (indicating a right skewed distribution).\

From above analysis of diabetes death rate, we can see in all the years, the diabetes death rate was higher among men than women.\

Lastly, I analyse the death rate that was caused by Heart Disease per year for both male and female:\
- In 2017, male had death rate caused by heart disease with mean 149.83  and median 95.03 (indicating a right skewed distribution) while female had death rate caused by heart disease with mean 91.17 and median 46.79 (indicating a right skewed distribution).\
- In 2018, male had death rate caused by heart disease with mean 145.74 and median 92.71  (indicating a right skewed distribution) while female had death rate caused by heart disease with mean 88.34 and median 49.71 (indicating a right skewed distribution).\
- In 2019, male had death rate caused by heart disease with mean 137.90 and median 88.59  (indicating a right skewed distribution) while female had death rate caused by heart disease with mean 82.20 and median 46.19 (indicating a right skewed distribution).\

From above analysis of heart disease death rate, we can see in all the years, the heart disease death rate was higher among men than women.\

In conclusion, the death rate caused by cancer, diabetes, and heart disease were all higher among men than women.

## Graphical Summary
After showing the numerical summary, I create graphical summary by using boxplot for cancer, diabetes, and heart disease death rate distributions.

### Cancer Death Rate Bloxpot:
```{r}
#Create boxplot for male cancer death rate by year
cancer_male_plot = ggplot(df_all, aes(x= as.character(year), y = cancer_males, fill = year))+
  stat_boxplot(geom = "errorbar",
               width = 0.15)+
  geom_boxplot()+
  labs(title = "Male Cancer Death Rate \n in European Countries by Year",
       subtitle = "using Boxplot",
       x = "Year",
       y = "Death Rate")+
  theme(plot.title = element_text(face="bold",hjust = 0.5),
        plot.subtitle = element_text(face="italic",hjust = 0.5, size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size= 10))

#Create boxplot for female cancer death rate by year
cancer_female_plot = ggplot(df_all, aes(x= as.character(year), y = cancer_females, fill = year))+
  stat_boxplot(geom = "errorbar",
               width = 0.15)+
  geom_boxplot()+
  labs(title = "FemaleCancer Death Rate of \n in European Countries by Year",
       subtitle = "using Boxplot",
       x = "Year",
       y = "Death Rate")+
  theme(plot.title = element_text(face="bold",hjust = 0.5),
        plot.subtitle = element_text(face="italic",hjust = 0.5, size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size= 10))

#Show the male and female cancer death rate plot side by side
grid.arrange(cancer_male_plot, cancer_female_plot, ncol=2)
```



In 2017, male death rate by cancer has right skewed distribution, which is also shown in the numerical summary part, where the mean is 342.0 and median is 323.3. The spread of the middle distribution is between 291.9 and 381.0 (IQR range of 89.1) and it is ranging from 214.7 to 473.1 (range value of 258.4). Where in 2018, male death rate by cancer has right skewed distribution, which is also shown in the numerical summary part, where the mean is 338.2 and median is 320.0. The spread of the middle distribution is between 284.1 and 380.1 (IQR range of 96) and it is ranging from 226.1 to 464.8 (range value of 238.7). And in 2019, male death rate by cancer has right skewed distribution, which is also shown in the numerical summary part, where the mean is 331.5 and median is 321.9. The spread of the middle distribution is between 276.7 and 377.6 (IQR range of 100.9) and it is ranging from 244.2 to 454.6 (range value of 210.4).\
There are no outlier in these distributions.\

In 2017, female death rate by cancer has left skewed distribution, which is also shown in the numerical summary part, where the mean is 198.6 and median is 201. The spread of the middle distribution is between 176.9 and 226.4 (IQR range of 49.5) and it is ranging from 121.7 to 263 (range value of 141.3). Where in 2018, female death rate by cancer has left skewed distribution, which is also shown in the numerical summary part, where the mean is 196.8 and median is 198.2. The spread of the middle distribution is between 174.0 and 224.0 (IQR range of 50.0) and it is ranging from 117.6 to 258.2 (range value of 140.6). And in 2019, female death rate by cancer has right skewed distribution, which is also shown in the numerical summary part, where the mean is 192.8 and median is 191.6. The spread of the middle distribution is between 174.5 and 218.3 (IQR range of 43.8) and it is ranging from 106.2 to 253.0 (range value of 146.8).\
There is one outlier located below the minimum value of year 2019 distribution.\

From the boxplots of cancer death rate above, we can see in all the years, the cancer death rate was higher among men than women, which is also shown in numerical analysis part.\

### Diabetes Mellitus Death Rate Bloxpot:
```{r}
#Create boxplot for male diabetes death rate by year
diabetes_male_plot = ggplot(df_diabetes, aes(x= as.character(year), y = diabetes_males, fill = year))+
  stat_boxplot(geom = "errorbar",
               width = 0.15)+
  geom_boxplot()+
  labs(title = "Male Diabetes Mellitus Death Rate \n in European Countries by Year",
       subtitle = "using Boxplot",
       x = "Year",
       y = "Death Rate")+
  theme(plot.title = element_text(face="bold",hjust = 0.5),
        plot.subtitle = element_text(face="italic",hjust = 0.5, size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size= 10))

#Create boxplot for female diabetes death rate by year
diabetes_female_plot = ggplot(df_diabetes, aes(x= as.character(year), y = diabetes_females, fill = year))+
  stat_boxplot(geom = "errorbar",
               width = 0.15)+
  geom_boxplot()+
  labs(title = "Female Diabetes Mellitus Death Rate \n in European Countries by Year",
       subtitle = "using Boxplot",
       x = "Year",
       y = "Death Rate")+
  theme(plot.title = element_text(face="bold",hjust = 0.5),
        plot.subtitle = element_text(face="italic",hjust = 0.5, size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size= 10))

#Show the male and female diabetes death rate plot side by side
grid.arrange(diabetes_male_plot, diabetes_female_plot, ncol=2)
```



In 2017, male death rate by diabetes has right skewed distribution, which is also shown in the numerical summary part, where the mean is 28.54 and median is 23.34. The spread of the middle distribution is between 18.65 and 38.48 (IQR range of 19.83) and it is ranging from 0.00 to 61.59 (range value of 61.59). Where in 2018, male death rate by diabetes has right skewed distribution, which is also shown in the numerical summary part, where the mean is 29.58 and median is 22.76. The spread of the middle distribution is between 17.67 and 40.71 (IQR range of 23.04) and it is ranging from 7.63 to 77.27 (range value of 69.64). And in 2019, male death rate by diabetes has right skewed distribution, which is also shown in the numerical summary part, where the mean is 30.31 and median is 24.04. The spread of the middle distribution is between 19.13 and 36.52 (IQR range of 17.39) and it is ranging from 7.3 to 106.97 (range value of 99.67).\
There are one outlier located above the maximum value in 2018 distribution and one outlier located above the maximum value in 2019 distribution.

In 2017, female death rate by diabetes has right skewed distribution, which is also shown in the numerical summary part, where the mean is 22.11 and median is 16.29. The spread of the middle distribution is between 12.42 and 29.32 (IQR range of 16.90) and it is ranging from 0.00 to 54.39 (range value of 54.39). Where in 2018, female death rate by diabetes has right skewed distribution, which is also shown in the numerical summary part, where the mean is 22.32 and median is 16.68. The spread of the middle distribution is between 12.08 and 28.82 (IQR range of 16.74) and it is ranging from 0.00 to 63.92 (range value of 63.92). And in 2019, female death rate by diabetes has right skewed distribution, which is also shown in the numerical summary part, where the mean is 22.81 and median is 16.64. The spread of the middle distribution is between 13.96 and 28.55 (IQR range of 14.59) and it is ranging from 5.88 to 86.56 (range value of 80.68).\
There are one outlier located above the maximum value in 2018 distribution and two outlier located above the maximum value in 2019 distribution.\

From the boxplots of diabetes mellitus death rate above, we can see in all the years, the diabetes mellitus death rate was higher among men than women, which is also shown in numerical analysis part.\

### Heart Disease Death Rate Bloxpot:
```{r}
#Create boxplot for male heart disease death rate by year
heart_male_plot = ggplot(df_all, aes(x= as.character(year), y = heart_males, fill = year))+
  stat_boxplot(geom = "errorbar",
               width = 0.15)+
  geom_boxplot()+
  labs(title = "Heart Disease Death Rate of Male \n in European Countries by Year",
       subtitle = "using Boxplot",
       x = "Year",
       y = "Death Rate")+
  theme(plot.title = element_text(face="bold",hjust = 0.5),
        plot.subtitle = element_text(face="italic",hjust = 0.5, size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size= 10))

#Create boxplot for female heart disease death rate by year
heart_female_plot = ggplot(df_all, aes(x= as.character(year), y = heart_females, fill = year))+
  stat_boxplot(geom = "errorbar",
               width = 0.15)+
  geom_boxplot()+
  labs(title = "Heart Disease Death Rate of Female \n in European Countries by Year",
       subtitle = "using Boxplot",
       x = "Year",
       y = "Death Rate")+
  theme(plot.title = element_text(face="bold",hjust = 0.5),
        plot.subtitle = element_text(face="italic",hjust = 0.5, size = 10),
        axis.title.x = element_text(size = 10),
        axis.title.y = element_text(size= 10))

#Show the male and female heart disease death rate plot side by side
grid.arrange(heart_male_plot, heart_female_plot, ncol=2)
```



In 2017, male death rate by heart disease has right skewed distribution, which is also shown in the numerical summary part, where the mean is 149.83 and median is 95.03. The spread of the middle distribution is between 61.73 and 176.68 (IQR range of 114.95) and it is ranging from 35.13 to 636.88 (range value of 601.75). Where in 2018, male death rate by heart disease has right skewed distribution, which is also shown in the numerical summary part, where the mean is 145.74 and median is 92.71. The spread of the middle distribution is between 64.35 and 178.88 (IQR range of 114.53) and it is ranging from 33.12 to 600.43 (range value of 567.31). And in 2019, male death rate by heart disease has right skewed distribution, which is also shown in the numerical summary part, where the mean is 137.90 and median is 88.59. The spread of the middle distribution is between 56.89 and 159.27 (IQR range of 102.38) and it is ranging from 32.57 to 558.28 (range value of 525.71).\
There are four outliers located above the maximum value in 2017 distribution, three outliers located above the maximum value in 2018 distribution, and four outliers located above the maximum value in 2019 distribution.

In 2017, female death rate by heart disease has right skewed distribution, which is also shown in the numerical summary part, where the mean is 91.17 and median is 46.79. The spread of the middle distribution is between 30.68 and 100.00 (IQR range of 69.32) and it is ranging from 13.42 to 408.00 (range value of 394.58). Where in 2018, female death rate by heart disease has right skewed distribution, which is also shown in the numerical summary part, where the mean is 88.34 and median is 49.71. The spread of the middle distribution is between 29.62 and 96.86 (IQR range of 67.24) and it is ranging from 12.31 to 381.51 (range value of 369.2). And in 2019, female death rate by heart disease has right skewed distribution, which is also shown in the numerical summary part, where the mean is 82.20 and median is 46.19. The spread of the middle distribution is between 26.69 and 105.29 (IQR range of 78.60) and it is ranging from 12.91 to 349.88 (range value of 336.97).\
There are four outliers located above the maximum value in 2017 distribution, three outliers located above the maximum value in 2018 distribution, and four outliers located above the maximum value in 2019 distribution.

From the boxplots of Heart Disease death rate above, we can see in all the years, the Heart Disease Death rate was higher among men than women, which is also shown in numerical analysis part.\


## Barplot to show death rate in each Euro countries in Year 2019
In this part, we can see from the barplots below that:\
- The highest death rate caused by cancer in 2019 for male was in Latvia, while for female was in Hungary.\
- The highest death rate caused by diabetes mellitus in 2019 for both male and female were in Croatia.\
- The highest death rate caused by heart disease in 2019 for both male and female were in Lithuania.\

```{r, fig.height = 10, fig.width = 7, fig.align = "center"}
#First of all, I create dataset that contains only year 2019
df_2019 <- subset(df_all,year == "2019")
#I create a ascending barplot for cancer death rate male and female in 2019 with below code.
#Male cancer death rate barplot in 2019:
ggplot(data = df_2019, aes(x = reorder(country, -cancer_males), 
                           y = cancer_males, fill = country)) +
  geom_bar(stat = "identity", width = 0.75,fill= "blue")+
  coord_flip() +
  labs(x = "Country", 
       y = "Male Cancer Death Rate", 
       title = "Male Cancer Death Rate by Euro Countries in Year 2019") +
  theme(plot.title = element_text(face="bold",hjust = 0.5, size= 10), 
        axis.title.x = element_text(face="italic", size = 10),
        axis.title.y = element_text(face="italic", size = 10))

#Female cancer death rate barplot in 2019:
ggplot(data = df_2019, aes(x = reorder(country, -cancer_females), 
                           y = cancer_females, fill = country)) +
  geom_bar(stat = "identity", width = 0.75,fill= "pink")+
  coord_flip() +
  labs(x = "Country", 
       y = "Female Cancer Death Rate", 
       title = "Female Cancer Death Rate by Euro Countries in Year 2019") +
  theme(plot.title = element_text(face="bold",hjust = 0.5, size= 10), 
        axis.title.x = element_text(face="italic", size = 10),
        axis.title.y = element_text(face="italic", size = 10))
```

```{r, fig.height = 10, fig.width = 7, fig.align = "center"}
#I create a ascending barplot for diabetes death rate male and female in 2019 with below code.
#Male diabetes death rate barplot in 2019:
ggplot(data = df_2019, aes(x = reorder(country, -diabetes_males), 
                           y = diabetes_males, fill = country)) +
  geom_bar(stat = "identity", width = 0.75,fill= "blue")+
  coord_flip() +
  labs(x = "Country", 
       y = "Male Diabetes Mellitus Death Rate", 
       title = "Male Diabetes Mellitus Death Rate by Euro Countries in Year 2019") +
  theme(plot.title = element_text(face="bold",hjust = 0.5, size= 10), 
        axis.title.x = element_text(face="italic", size = 10),
        axis.title.y = element_text(face="italic", size = 10))

#Female diabetes death rate barplot in 2019:
ggplot(data = df_2019, aes(x = reorder(country, -diabetes_females), 
                           y = diabetes_females, fill = country)) +
  geom_bar(stat = "identity", width = 0.75,fill= "pink")+
  coord_flip() +
  labs(x = "Country", 
       y = "Female Diabetes Mellitus Death Rate", 
       title = "Female Diabetes Mellitus Death Rate by Euro Countries in Year 2019") +
  theme(plot.title = element_text(face="bold",hjust = 0.5, size= 10), 
        axis.title.x = element_text(face="italic", size = 10),
        axis.title.y = element_text(face="italic", size = 10))
```

```{r, fig.height = 10, fig.width = 7, fig.align = "center"}
#I create a ascending barplot for heart disease death rate male and female in 2019 with below code.
#Male heart disease death rate barplot in 2019:
ggplot(data = df_2019, aes(x = reorder(country, -heart_males), 
                           y = heart_males, fill = country)) +
  geom_bar(stat = "identity", width = 0.75,fill= "blue")+
  coord_flip() +
  labs(x = "Country", 
       y = "Male Heart Disease Death Rate", 
       title = "Male Heart Disease Death Rate by Euro Countries in Year 2019") +
  theme(plot.title = element_text(face="bold",hjust = 0.5, size= 10), 
        axis.title.x = element_text(face="italic", size = 10),
        axis.title.y = element_text(face="italic", size = 10))

#Female heart disease death rate barplot in 2019:
ggplot(data = df_2019, aes(x = reorder(country, -heart_females), 
                           y = heart_females, fill = country)) +
  geom_bar(stat = "identity", width = 0.75,fill= "pink")+
  coord_flip() +
  labs(x = "Country", 
       y = "Female Heart Disease Death Rate", 
       title = "Female Heart Disease Death Rate by Euro Countries in Year 2019") +
  theme(plot.title = element_text(face="bold",hjust = 0.5, size= 10), 
        axis.title.x = element_text(face="italic", size = 10),
        axis.title.y = element_text(face="italic", size = 10))
```


## Correlation Test
In this part, I would like to create correlation test to see the relationship between two numerical variables in the dataset using Pearson method and identify which variables are strongly correlated.\

Here, I list the four most strongly correlated pairs:\


- Heart males death rate and heart females death rate have a strong positive correlation with correlation of 0.98.\
- Diabetes males death rate and diabetes females death rate have a strong positive correlation with correlation of 0.97.\
- Cancer males death rate and heart males death rate have a moderate positive correlation with correlation of 0.66.\
- Cancer males death rate and cancer females death rate have a moderate positive correlation with correlation of 0.64.\

```{r}
#Create dataset for numerical variables only
df_numerical <- df_all %>%
  select(-country, -year)
#Standardized the numerical variables
df_numerical<- as.data.frame(scale(df_numerical))
```

```{r}
#Show the correlation of the numerical variables in the dataset using Pearson Method
round(cor(df_numerical),
  digits = 2 # rounded to 2 decimals
)
```

## Linear Regression
I create a linear regression model to predict the cancer death rate of males with the predictor variables as follow: cancer females, diabetes males, diabetes females, heart males, and heart females.

```{r}
mod <- lm(cancer_males ~ ., data = df_numerical)
summary(mod)
```

Here, I interpret the coefficients that are shown in the figure above:\


- The cancer females death rate coefficient in the regression equation is $5.415 × 10^{-1}$. This coefficient represents the mean increase of cancer males death rate for every additional unit in cancer females death rate. If the cancer females death rate increases by 1 unit, the average cancer males death rate increases by $5.415 × 10^{-1}$ (holding all the other independent variables constant).\



- The diabetes males death rate in the regression equation is $-7.612 × 10^{-1}$. This coefficient represents the mean decrease of cancer males death rate for every additional unit in diabetes males death rate. If the diabetes males death rate increases by 1 unit, the cancer males death rate decreases by $7.612 × 10^{-1}$ (holding all the other independent variables constant).\



- The diabetes females death rate in the regression equation is $8.789 × 10^{-1}$. This coefficient represents the mean increase of cancer males death rate for every additional unit in diabetes females. If the diabetes females death rate increases by 1 unit, the average cancer males death rate increases by $8.789 × 10^{-1}$ (holding all the other independent variables constant).\



- The heart males death rate in the regression equation is $1.599 × 10^{-2}$. This coefficient represents the mean increase of cancer males death rate for every additional unit in heart males. If the heart males death rate increases by 1 unit, the average cancer males death rate increases by $1.599 × 10^{-2}$ (holding all the other independent variables constant).\



- The heart females death rate in the regression equation is $4.692 × 10^{-1}$. This coefficient represents the mean increase of cancer males death rate for every additional unit in heart males. If the heart males death rate increases by 1 unit, the average cancer males death rate increases by $4.692 × 10^{-1}$ (holding all the other independent variables constant).\



- When all the predictor measurements are equal to zero, the cancer males death rate is $1.235 × 10^{-16}$.\



- Then, I observe the p-value and compare it with significance level of 5%. We can see that cancer females death rate, diabetes males death rate, diabetes females death rate have p-value < 0.05. Thus, these variables are considered as significant predictor. This also indicates that relations exist between them with the cancer males death rate.\


- Lastly, I observe the adjusted  $R^{2}$  in this fitted model which is 0.6963. Thus, 69.63% of the variation in cancer males death ratecan be explained by fitted model.\



# Part 2: R Package
In this part, I find an existing R package, that we didn’t use extensively in the course, and write a report demonstrating its use using R Markdown. 
The package that I choose is tidyr package.\

The sole purpose of the tidyr package is to simplify the process of creating tidy data. Tidy data describes a standard way of storing data that is used wherever possible throughout the tidyverse.
```{r}
#Download and install the tidyverse package 
#install.packages("tidyr")
#Load the package
#library(tidyr) -> This has been done in the load package part
#Running the following code will give the description of the tidyr package functions that I use below
?gather
?separate
?unite
?spread
```

### 1. Gather function from tidyr package
gather() function: It takes multiple columns and gathers them into key-value pairs. Basically it makes “wide” data longer. The gather() function will take multiple columns and collapse them into key-value pairs, duplicating all other columns as needed.
```{r}
#Using gather() function on df_cancer dataset
df_cancer_gather <- df_cancer %>% 
  gather(Gender, Rate, cancer_males:cancer_females)
  
#Print the head and tail of the data in a long format
head(df_cancer_gather)
tail(df_cancer_gather) 
```

### 2. Separate function from tidyr package
separate() function: It converts longer data to a wider format and turns a single character column into multiple columns.
```{r}
#Use separate() function to make data wider
df_cancer_separate <- df_cancer_gather %>% 
            separate(Gender, c("Disease", 
                              "Gender"))

#Print the head and tail of the data
head(df_cancer_separate)
tail(df_cancer_separate)
```


### 3. Unite function from tidyr package
unite() function: It is the compliment of separate. To undo separate(), we can use unite(), which merges two variables into one. Here, we will merge two columns Disease and Gender with a separator “_”
```{r}
#Use unite() function to glue Disease and Gender columns
df_cancer_unite <- df_cancer_separate %>%
            unite(Gender, Disease, 
                  Gender, sep = "_")

#Print the head of the data
head(df_cancer_unite)
```

### 4. Spread function from tidyr package
spread() function: It helps in reshaping a longer format to a wider format. The spread() function spreads a key-value pair across multiple columns.
```{r}
# use spread() function to make data wider
df_cancer_spread <- df_cancer_unite %>% 
            spread(Gender, Rate)

#Print the head of the data
head(df_cancer_spread)
```

# References
- Tidyr package in R programming. GeeksforGeeks. (2020, August 6). Retrieved December 20, 2022, from https://www.geeksforgeeks.org/tidyr-package-in-r-programming/ 

- Death Caused. Database - Eurostat. (n.d.). Retrieved December 20, 2022, from https://ec.europa.eu/eurostat/web/main/data/database 

- Historical data. Met Éireann - The Irish Meteorological Service. (n.d.). Retrieved December 20, 2022, from https://www.met.ie/climate/available-data/historical-data 












